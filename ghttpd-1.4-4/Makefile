# Generated by Gareth Owen <gaz@athene.co.uk>

CC = gcc
CFLAGS = -g -O2
LDFLAGS = 
LIBS = 
DESTDIR = /usr/local/ghttpd

OBJ = main.o protocol.o util.o

default: ghttpd

ghttpd: $(OBJ)
	$(CC) $(LDFLAGS) -o $@ $(OBJ) $(LIBS)


install: ghttpd
	mkdir -p $(DESTDIR)
	mkdir -p $(DESTDIR)/cgi-bin
	mkdir -p $(DESTDIR)/htdocs
	cp -f ghttpd $(DESTDIR)/
	cp -f 404.html $(DESTDIR)/
	cp -f cgierror.html $(DESTDIR)/
	cp -f cmderror.html $(DESTDIR)/
	cp -f ghttpd.conf /etc/
	cp -f index.html $(DESTDIR)/htdocs/
	chown nobody.nobody $(DESTDIR)
	chown nobody.nobody $(DESTDIR)/*
	chown nobody.nobody $(DESTDIR)/htdocs/*

clean:
	rm -f *.o ghttpd

